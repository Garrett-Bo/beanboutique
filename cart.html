<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bean Boutique - Cart</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/coffee.css">
    <link rel="stylesheet" href="css/cart.css">
    <link rel="stylesheet" href="css/hompage.css">
</head>
<body>

    <header class="main-header">
        <div class="container">
            <nav class="main-nav">
                <button class="mobile-menu-button" aria-label="Open navigation menu">
                    <span class="hamburger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>
                <a href="index.html" class="logo">Bean Boutique</a>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="coffee.html">Coffee</a></li>
                    <li><a href="equipment.html">Equipment</a></li>
                    <li><a href="events.html">Events</a></li>
                    <li><a href="offers.html">Offers</a></li>
                </ul>
                <a href="cart.html" class="btn-cart">Cart (<span id="cart-count">0</span>)</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="hero hero-small" data-bg="image/cart-hero.png">
            <div class="hero-content">
                <h1>Your Cart</h1>
                <p>Review your selected coffees and equipment before checkout.</p>
            </div>
        </section>

        <section class="section">
            <h2 class="visually-hidden">Cart Details</h2>
            <div class="container">
                <div id="cart-container">
                    <!-- Cart items will be rendered here -->
                </div>
                <div id="cart-summary" class="cart-summary">
                    <!-- Cart summary will be rendered here -->
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 Bean Boutique. All Rights Reserved.</p>
                <p>Designed with &hearts; in-house. No templates were used.</p>
            </div>
        </div>
    </footer>
    <script src="assets/cart-functions.js"></script>
    <script>
    // --- Cart Logic ---

    // Utility: Get cart from localStorage
    function getCart() {
        return JSON.parse(localStorage.getItem('beanboutique_cart') || '[]');
    }

    // Utility: Save cart to localStorage
    function saveCart(cart) {
        localStorage.setItem('beanboutique_cart', JSON.stringify(cart));
    }

    // Utility: Update cart count in header
    function updateCartCount() {
        const cart = getCart();
        document.getElementById('cart-count').textContent = cart.reduce((sum, item) => sum + item.qty, 0);
    }

    // Render cart items
    function renderCart() {
        const cart = getCart();
        const cartContainer = document.getElementById('cart-container');
        const cartSummary = document.getElementById('cart-summary');

        if (cart.length === 0) {
            cartContainer.innerHTML = '<p class="cart-empty">Your cart is empty.</p>';
            cartSummary.innerHTML = '';
            return;
        }

        let total = 0;
        cartContainer.innerHTML = cart.map((item, idx) => {
            const itemTotal = item.price * item.qty;
            total += itemTotal;
            return `
                <div class="cart-item">
                    <img src="${item.img}" alt="${item.name}">
                    <div class="cart-item-info">
                        <h3>${item.name}</h3>
                        <p class="cart-item-type">${item.type}</p>
                        <p class="cart-item-price">$${item.price.toFixed(2)}</p>
                        <div class="cart-qty">
                            <button class="qty-btn" onclick="changeQty(${idx}, -1)">-</button>
                            <span>${item.qty}</span>
                            <button class="qty-btn" onclick="changeQty(${idx}, 1)">+</button>
                        </div>
                        <button class="remove-btn" onclick="removeItem(${idx})">Remove</button>
                    </div>
                    <div class="cart-item-total">$${itemTotal.toFixed(2)}</div>
                </div>
            `;
        }).join('');

        cartSummary.innerHTML = `
            <div class="cart-summary-inner modern-summary">
                <h3>Order Summary</h3>
                <p class="summary-subtotal"><strong>Subtotal:</strong> $${total.toFixed(2)}</p>
                <div class="payment-section">
                    <h4>Payment Options</h4>
                    <div class="payment-options">
                        <label class="payment-radio"><input type="radio" name="payment" value="visa" checked> <img src="https://upload.wikimedia.org/wikipedia/commons/4/41/Visa_Logo.png" alt="Visa" class="pay-icon" id="visa"></label>
                        <label class="payment-radio"><input type="radio" name="payment" value="paypal"> <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal" class="pay-icon" id="paypal"></label>
                        <label class="payment-radio"><input type="radio" name="payment" value="bank"> <span class="pay-icon bank-icon">üè¶</span></label>
                    </div>
                    <div class="payment-fields" id="payment-fields">
                        <div id="card-fields">
                            <input type="text" placeholder="Card Number" maxlength="19" class="modern-input" required>
                            <input type="text" placeholder="Name on Card" class="modern-input" required>
                            <div class="row-fields">
                                <input type="text" placeholder="MM/YY" maxlength="5" class="modern-input" required>
                                <input type="text" placeholder="CVV" maxlength="4" class="modern-input" required>
                            </div>
                        </div>
                        <div id="paypal-fields" class="hidden">
                            <input type="email" placeholder="PayPal Email" class="modern-input" required>
                        </div>
                        <div id="bank-fields" class="hidden">
                            <input type="text" placeholder="Bank Account Number" class="modern-input" required>
                            <input type="text" placeholder="Account Holder Name" class="modern-input" required>
                        </div>
                    </div>
                </div>
                <button class="checkout-btn modern-checkout" id="submitOrderBtn">Submit Order</button>
            </div>
            <div id="payment-complete-modal" class="modal-overlay">
                <div class="discount-modal-content">
                    <button class="close-modal" id="closePaymentComplete">&times;</button>
                    <h3>Payment Complete!</h3>
                    <p>Your order has been placed successfully. Thank you for shopping with Bean Boutique!</p>
                </div>
            </div>
        `;
        // Attach event listeners after rendering
        document.querySelectorAll('input[name="payment"]').forEach(function(radio) {
            radio.addEventListener('change', function() {
                document.getElementById('card-fields').classList.toggle('hidden', this.value !== 'visa');
                document.getElementById('paypal-fields').classList.toggle('hidden', this.value !== 'paypal');
                document.getElementById('bank-fields').classList.toggle('hidden', this.value !== 'bank');
            });
        // Set initial visibility based on checked payment option
        var checked = document.querySelector('input[name="payment"]:checked');
        if (checked) {
            document.getElementById('card-fields').classList.toggle('hidden', checked.value !== 'visa');
            document.getElementById('paypal-fields').classList.toggle('hidden', checked.value !== 'paypal');
            document.getElementById('bank-fields').classList.toggle('hidden', checked.value !== 'bank');
        }
        });
        document.getElementById('closePaymentComplete').onclick = function() {
            document.getElementById('payment-complete-modal').style.display = 'none';
        };
        document.getElementById('submitOrderBtn').onclick = function(e) {
            e.preventDefault();
            document.getElementById('payment-complete-modal').style.display = 'flex';
            setTimeout(function() {
                document.getElementById('payment-complete-modal').style.display = 'none';
                localStorage.removeItem('beanboutique_cart');
                renderCart();
                updateCartCount();
            }, 400);
        };
    }

    // Change quantity
    function changeQty(idx, delta) {
        const cart = getCart();
        if (cart[idx].qty === 1 && delta === -1) {
            removeItem(idx);
            return;
        }
        cart[idx].qty += delta;
        if (cart[idx].qty < 1) cart[idx].qty = 1;
        saveCart(cart);
        renderCart();
        updateCartCount();
    }

    // Remove item
    function removeItem(idx) {
        const cart = getCart();
        cart.splice(idx, 1);
        saveCart(cart);
        renderCart();
        updateCartCount();
    }

    // Checkout (demo only)
    function checkout() {
        // Show payment complete modal if it exists
        var modal = document.getElementById('payment-complete-modal');
        if (modal) {
            modal.style.display = 'flex';
            document.getElementById('closePaymentComplete').onclick = function() {
                modal.style.display = 'none';
            };
            // Optionally clear cart after a short delay
            setTimeout(function() {
                localStorage.removeItem('beanboutique_cart');
                renderCart();
                updateCartCount();
            }, 2000);
        } else {
            // fallback: just clear cart
            localStorage.removeItem('beanboutique_cart');
            renderCart();
            updateCartCount();
        }
    }

    // On page load
    renderCart();
    updateCartCount();

    // --- Add to Cart logic for other pages ---
    // This code should be included in coffee.html, equipment.html, offers.html, etc.
    // Example usage (add this to your product card button onclick):
    // addToCart({name, price, img, type})

    window.addToCart = function(product) {
        const cart = getCart();
        const existing = cart.find(item => item.name === product.name && item.type === product.type);
        if (existing) {
            existing.qty += 1;
        } else {
            cart.push({...product, qty: 1});
        }
        saveCart(cart);
        updateCartCount();
    };

    // Mobile menu toggle
    document.querySelector('.mobile-menu-button').addEventListener('click', () => {
        const navUl = document.querySelector('.main-nav ul');
        navUl.style.display = navUl.style.display === 'flex' ? 'none' : 'flex';
        navUl.style.flexDirection = 'column';
        navUl.style.position = 'absolute';
        navUl.style.top = '60px';
        navUl.style.left = '0';
        navUl.style.width = '100%';
        navUl.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        navUl.style.padding = '1rem 0';
        navUl.style.boxShadow = '0 2px 4px rgba(0,0,0,0.05)';
    });

    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.hero.hero-small[data-bg]').forEach(function(section) {
            var bg = section.getAttribute('data-bg');
            if (bg) {
                section.style.backgroundImage = 'url(' + bg + ')';
            }
        });
    });
    </script>

    <script>
        // --- MOBILE NAVBAR LOGIC ---
        const mobileMenuBtn = document.querySelector('.mobile-menu-button');
        const navUl = document.querySelector('.main-nav ul');
        const logo = document.querySelector('.main-nav .logo');
        const cartBtn = document.querySelector('.btn-cart');

        function closeMobileMenu() {
            navUl.classList.remove('show');
            mobileMenuBtn.classList.remove('open');
        }
        function openMobileMenu() {
            navUl.classList.add('show');
            mobileMenuBtn.classList.add('open');
        }
        mobileMenuBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            if (navUl.classList.contains('show')) {
                closeMobileMenu();
            } else {
                openMobileMenu();
            }
        });
        document.addEventListener('click', function(e) {
            if (window.innerWidth < 1024 && navUl.classList.contains('show')) {
                if (!navUl.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                    closeMobileMenu();
                }
            }
        });
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 1024) {
                navUl.classList.remove('show');
                navUl.style.display = 'flex';
                navUl.style.flexDirection = 'row';
                navUl.style.position = 'static';
                navUl.style.backgroundColor = 'transparent';
                navUl.style.boxShadow = 'none';
            } else {
                closeMobileMenu();
            }
        });
        // Smaller logo font for mobile
        function updateLogoFont() {
            if (window.innerWidth < 600) {
                logo.style.fontSize = '1.2rem';
                logo.style.letterSpacing = '0.5px';
            } else {
                logo.style.fontSize = '';
                logo.style.letterSpacing = '';
            }
        }
        window.addEventListener('resize', updateLogoFont);
        document.addEventListener('DOMContentLoaded', updateLogoFont);
    </script>

</body>
</html>